# Assignment 3

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>


## 一、频域滤波

给定图像 ‘barb.png’ ， 利用**一阶** Butterworth 低通滤波器进行频域滤波， **当 D 0 = 10,20,40,80 时**，给出相应滤波图像，并分别以频域和空域的观点解释有关滤波结果。

提示：

（1）以$(-1)^{(x+y)}$乘以输入图像进行中心变换；

（2）直接以FFT2进行傅立叶变换； 

（3）DFT反变换后取实部；

（4）以$(-1)^{(x+y)}$乘以（3）中结果，反中心变换。



### 算法描述

#### a) 二维离散傅立叶变换

$$
F(u,v)=\frac{1}{MN}\sum_{0}^{M-1}\sum_{0}^{N-1}f(x,y)e^{-j2\pi(\frac{ux}{M}+\frac{vy}{N})}
$$
**其中f(x,y)为输入的M*N图像，F(u,v)为二维频谱系数，u和v可用于确定正余弦的频率，F(u,v) 所在坐标系被称为频域。显然频域矩阵的大小与原空间域矩阵大小相同。**

得到的频谱图像一般为

![1](Assets/1.jpg)

![1](Assets/3.jpg)



为了便于频域的滤波和频谱的分析，常常在变换之前进行频谱的中心化。根据频域平移性的性质有：
$$
   F(u-u_0,v-v_0)=f(x,y)e^{j2\pi(\frac{u_0x}{M}+\frac{v_0y}{N})}
$$

   当$u_0=\frac{M}{2},v_0=\frac{N}{2}$时，$e^{j2\pi(\frac{u_0x}{M}+\frac{v_0y}{N})}=(-1)^{x+y}$

从数学上说是在变换之前用指数项乘以原始函数，又因为$e^{j\pi}=1$，所以往往我们在写程序的时候实际上是把原始矩阵乘以$(-1)^{x+y}$**达到平移频域坐标原点至屏幕正中央的目的**。如下图所示：1<----->3 对调，2<----->4 对调，如matlab中的fftshit命令，可以将频域的坐标原点从显示屏起始点（0，0） 移至显示屏的中心点。

![1](Assets/2.jpg)





#### b) 频域滤波

![1](Assets/4.jpg)

####  c) 理想低通滤波器（ILPF）

ILPF可以截断傅立叶变化中所有高频成分
$$
H(u,v)=\begin{cases}
   1 & D(u,v)\leq D_0 \\
   0 & D(u,v)>D_0\\
   \end{cases}，其中D(u,v) = \sqrt{u^2+v^2}
$$
以D0为半径的圆内所有频率分量无损的通过，圆外的所有频率分量完全衰减。**注意：傅立叶变换是酉变换，不改变信号能量**根据测不准原理，这时D0越小对应的空域模板越大，即空域卷积核越大，当D0趋近于0的时候，形成冲积函数，所有频率信息无损通过。



遇到的问题：

   1. 理想低通滤波器H(u)在频域是矩形，其空域滤波器核h(x)是sinc函数
   2. sinc会有正负震荡，导致出现振铃现象

原因：在截止频率D0附近对频谱过于“粗暴”的截断



#### d）改进后的Butterworth低通滤波器

n阶
$$
H(u,v) = \frac{1}{1+(\frac{\sqrt{u^2+v^2}}{D_0})^{2n}}
$$

n = 1,1阶，完全无振铃现象
$$
H(u,v) = \frac{1}{1+(\frac{u^2+v^2}{D_0})}
$$

1. 滤波器对（0，0）对称，对各方向的频率成分有相同效果。
2. 不同于ILPF，随着（u，v）增加，对频率成分是逐渐衰减，可有效抑制振铃现象。
3. 当n增加时，对频率成分趋于锐截断，振铃效果增强。

**模糊减少的原因在于：当和ILPF采用同样D0时，BLPF可以保留更多高频成分**



### 源码实现



### 显示结果

![res1](Assets/5.jpg)

![res1](Assets/6.jpg)









## 二、同态滤波

采用同态滤波来增强图像‘office.jpg’细节，对数频域滤波器为：
$$
H(u,v)=(\gamma_H-\gamma_L)[1-e^{-c[D^2(u,v)/D_0^2]}]+\gamma_L
$$
（1）参数选择：参考$\gamma_H=2,\gamma_L=0.25,C=1$

（2）自己尝试不同的 D0 以得到最好的结果。

（3）如将滤波器替换为一阶 Butterworth 高通滤波器，比较滤波结果。

提示：对于滤波输出图像，确定图像的最大和最小像素值 max 和 min ，得到 $range=max-min$，对于$f(x,y)$，以$255*(f(x,y)-min)/range$，得到最好的显示效果。











